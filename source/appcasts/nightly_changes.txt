2020-01-21: Enable secure timestamps for iTerm2,
image_decoder, and pidinfo

2020-01-21: Fix entitlements and secure timestamp for
Sparkle framework.

Sparkle was built from my fork at commit
bb5d87c186c9590cc21c1d4e66907d3fd21ce6c5

2020-01-20: When buring session on attach, use the gateway's
window origin as the origin for the first tmux window that
doesn't have an entry in @origins. Issue 8639

2020-01-20: Move image_decoder into Contents/MacOS. Issue
8625

2020-01-20: Refactor profiles menu

2020-01-20: Make custom command the tooltip for profile menu
items. Issue 8635

2020-01-20: Deal with not being able to find a font more
gracefully. Issue 8631

2020-01-20: Add debug logging to dropdown find view
controller for issue 6425

2020-01-19: Update Sparkle to 1.22.0

This is built from the forked_1.22.0 branch of
https://github.com/gnachman/Sparkle at commit
d51bd2de29761611b38648670049d6b7e456a9e9.

2020-01-19: Add hardened runtime to image_decoder

2020-01-19: Add more debug logging for initial session size
for issue 7481

2020-01-19: Make highlighted search results in the profile
list legible in dark mode

2020-01-19: Add pref to edit session to prevent APS. Issue
8614

2020-01-19: Don't crash on bad base64 passed to
ReportVariable. Issue 8621

2020-01-19: Make tab lable font size customizable. Issue
8609

2020-01-19: Fix signing settings for pidinfo target

2020-01-19: Add notarization to adhoc

2020-01-19: Add debug logging to keydown code path for issue
8620

2020-01-19: Implement mouse reporting frustration detection.
Issue 7799

2020-01-18: Enable DVRDEBUG in debug builds to diagnose
crashes

2020-01-17: Disable accent menu

2020-01-17: Put XPC service behind advanced pref

2020-01-17: Limit how many threads can get wedged while
waiting for the pidinfo service to start

2020-01-17: Eliminate synchronous: argument. Make
applescript do a dispatch_async before calling
resumeExecutionWithResult because it is a dumb api

2020-01-17: Remove most of safelySetStyleMask: because the
issue was fixed in 6980b22ed15dd03c4396ea52745ce0e753fbc6f6

2020-01-17: Prevent rentrant calls to setStyleMask:

2020-01-17: Make proc_pidinfo asynchronous and
out-of-process. Issue 8615.

This commit adds a pidinfo xpc service. It runs proc_pidinfo
in a concurrent dispatch queue. It counts the number of
times it gets wedged and then kills itself when it exceeds a
threshold.

A few other bugs were fixed along the way: - Fxes a bug
where toggling fullscreen on a hotkey window hides it.  -
The proxy icon's URL is now always the local directory - The
last local directory is now tracked separately from the last
directory, which may or may not be on a remote host.

2020-01-11: Fix restoration for custom shells. The
kProgramType was wrong. Issue 8616

2020-01-11: When a single character is selected, show its
foreground and background color in the context menu

2020-01-09: Add keyboard shortcuts for announcements. Arcify
the announcement vc. Issue 8611

2020-01-09: Improve description of
tmuxVariableWindowSizesSupported to indicate tmux version
requirement

2020-01-09: Place top-of-screen window under menu bar on
non-first monitor when displays have separate spaces. Issue
8528

2020-01-09: Update tab bar when changing the 'flash tab bar'
setting

2020-01-09: Turn off flash tab bar in fullscreen by default.
Now that the tab bar is a title bar accessory, it can simply
behave like a normal app.

2020-01-09: Fix bug introduced by commit
2067c5e19b3b2ab6aabc8a0d71d7aad3ad73f7df that caused the tab
bar not to be visible when revealing the menu bar in native
full screen, which was noticed in issue 8603 (1/8 comment by
nicm). A gray bar does appear when switching from regular to
minimal theme, but that's a better bug to live with.

2020-01-09: Deliver scroll wheel momentum events to the view
under the mouse, not first responder.

2020-01-08: Arcify SCPFile and improve appearance of items
in the downloads/uploads menu

2020-01-06: Add advanced pref to force AA on retina displays

2020-01-05: Move bookmark launching code out of
iTermController to resolve a todo

2020-01-05: Fix some warnings

2020-01-05: Make xcode shut up about updating settings. You
can take my command line code signing from my cold dead
keyboard you sob

2020-01-05: Notarize the nightly build

2020-01-04: Fix voice dictation. Issue 5715

2020-01-04: Update tmux window opening mode pref text to
explain its purpose more clearly. Issue 8598

2020-01-04: Don't call a nil function pointer

2020-01-04: Fix a bug where patterned images wouldn't change
when not using the GPU renderer. Issue 8557

2020-01-04: Add missing semicolon

2020-01-04: Fix a bug where splitting a tmux pane in Python
wouldn't return a session. Issue 8601

2020-01-04: When logging in plaintext exclude tmux gateway
traffic. Fix a bug where after logging raw data you can't
log in plaintext subsequently.

2020-01-04: Improve error reporting for dynamic profiles,
and fix a crash when the root element is not a dictionary

2020-01-04: Migrate UB sanitizer setting

2020-01-04: Put percent before pane number when gettings its
process ID

2020-01-03: Use different icons for beta and nightly

2020-01-02: Fix vertical alignment of image assets in git
status bar components. The 10.15 SDK draws strings in a
different place for some reason.

2020-01-01: Fix vertical alignment on retina displays of new
output indicator and dead-session indicator. The bell also
moves down half a point, and it doesn't seem to look any
better or worse to my eyes.

2020-01-01: Don't use @uservars in tmux integration prior to
tmux 3.0. Issue 8596

2019-12-31: Add .its file as openable file

2019-12-31: Fix popover size in jsonpretty example

2019-12-31: Add gmtlock.its

2019-12-31: Convert tabs to spaces in gmtclock.rst

2019-12-31: Fix force click to smart select. Besides
stopping live selection prior to performing smart selection,
we must also not clear it on mouse-up.

2019-12-31: Set an upper bound of 1250x1250 for initial
session size. Issue 8592

2019-12-31: Combine profile debug logs into a single
structure. Add logging at more locations.

2019-12-30: Disable tab icon on macOS 10.12 and hide the
pref. I can't get it to work and it's a nightmare to develop
on old macoses.

2019-12-30: Don't flip custom tab icons on 10.15

2019-12-30: Don't use flipped images in tab icons on 10.15

2019-12-30: Add TODOs for logging

2019-12-30: [python] Fix more pylint issues

2019-12-30: [python] Fix off by one error when getting
content of multiple selection where the last character was
elided improperly

2019-12-30: [python] Respect timeout when registering
statusbar

2019-12-30: [python] Fix mypy, pycodestyle, and pylint
complaints.

A number of pylint errors had to be silenced, particularly
because it can't handle protobufs.

Some problems were silenced for backward compatibility
reasons: I can't break public APIs for a naming issue, etc.

A few were silenced because fixing them is riskier than
leaving the imperfect code in place.

2019-12-25: Update internet access policy for all outgoing
connections

2019-12-25: Inject banner text into repl session rather than
passing it through the banner command line argument

2019-12-25: Abort paste when blocking for prompt with ^C and
esc. Issue 8094

2019-12-24: Add an advanced pref to not copy background
colors

2019-12-24: Add Ignore as pointer action. Issue 8576

2019-12-24: Strip leading hyphens in extract URL. We detect
a URL by searching backward from the first colon to the
beginning of the scheme. We support hyphens in schemes
because Google ruined URLs with chrome-devtools. In issue
8588 it is revealed that we will pick up dozens of leading
hyphens in emacs.

2019-12-23: Move fullscreen hotkey window to its preferred
screen before making it key so the dock won't get hidden on
the wrong window. Issue 8487

2019-12-23: Fix a bug where 'select menu item' actions get
performed twice. Issue 8587

2019-12-23: Reset mouseDownOnSelection in mouseUp. Issue
8538

2019-12-23: Use RGB color space for black in
underline/strikethrough mask because the callee expects 4
color components

2019-12-23: Make scrolling cancel three-finger tap gesture.
Issue 8538

2019-12-22: Fix printing black and white images. Issue 8581

2019-12-22: On catalina, default to using the built in mouse
cursor for i-beam. Overlay it with a circle for mouse
reporting.

2019-12-22: Add proper error reporting for dynamic profiles

2019-12-22: Save user-defined vars in tmux server. Issue
8516

2019-12-22: Add skip button to shell integration installer

2019-12-22: Refactor shell integration installer

2019-12-22: Minor cleanup

2019-12-22: Redo shell integration installer UI

2019-12-22: End live selection on mouse up. Fixes a bug
where a three finger tap followed by a scroll would begin
selecting text

2019-12-19: Make mouse drag cancel a three-finger tap
gesture. Issue 8538

2019-12-19: Prevent crazy behavior when dragging past the
255-32nd column in xterm mouse reporting

2019-12-19: Add advanced pref to draw solid underlines.
Issue 8561

2019-12-19: [tmux] Offer to force detach when tmux is
unresponsive and you're trying something destructive (kill
window, pane, session). Issue 8560

2019-12-19: [tmux integration] Double-attachment polish.

Offer to force detach other when already attached to tmux.

Fix "reveal" behavior in this case to show a session rather
than just the session's window.  If you try to detach twice,
offer to force detach.

Issue 8559

2019-12-19: Add Send Selection to context menu. Issue 3590.

2019-12-17: Reflect changes to custom touch bar items right
away. Issue 8542

2019-12-17: Remove various entitlements that are not needed

2019-12-16: Fix bug that broke selection

2019-12-15: Change colorspace of IBarCursor to sRGB. Before
it was grayscale and that broke screen sharing. Issue 8411

2019-12-15: Call scrollWheel: on momentum changed and ended
phases. macOS does not call these for some reason. Based on
a bit of disassembling, it's because
+NSAnimationContext.activate returns true. Issue 8538

2019-12-15: Add more debug logging to character generation

2019-12-15: Use secure coding for .itr files

2019-12-15: Confirm control sequence-initiated downloads

2019-12-14: Report three finger drags. Issue 8524

2019-12-14: Hide PTYScrollView's content view when using
metal renderer for a nice performance bump. Issue 8515

2019-12-13: [ColorPicker] Rename cornerRadius to
cpk_cornerRadius. Apple added a private -setCornerRadius:
method on NSView whose very existence causes a corner radius
to be applied. Objective C at its worst!

2019-12-13: Change tilde expansion in iterm2_git_poll to
only expand leading tildes. Issue 8558

2019-12-12: Fix crash when undo removes a trigger

2019-12-12: Move set background image nag into nagging
controller. Nag even when unsetting the background image

2019-12-11: Move Do you want the scroll wheel to move the
cursor in interactive programs like this to nag controller

2019-12-11: Move tmux supplementary plane announcement to
nag controller

2019-12-11: Add didRepairSavedArrangement to nag controller

2019-12-11: Move abort upload nag to nag controller

2019-12-11: Move abort download to nag controller

2019-12-11: Move orphan and broken pipe nags to nag
controller

2019-12-11: Move arrangement with unknown profile nag into
nag controller

2019-12-11: Request permission to report variables

2019-12-09: Make restoring and updating-on-resize of notes
and selection much more robust. Add a bunch of tests.

2019-12-07: Fix restoration of annotations. The screen's
initial size during restoration is usually different than
when it was saved. That broke restoring annotations because
the saved coordinates are a function of screen width. This
commit sets the screen size back to its initial value before
loading the annotations and then the VT100Screen restoration
function returns. PTYSession can then restore its selection
(which is also dependent on width) and then fix the screen
size back to what will actually fit in the physical window
we have. That window often gets resized again later.

There's still a bug with selection restoration when there
are more than 10k lines prior to state saving. The selection
shifts vertically because it doesn't account for the
truncation.

2019-12-07: Split navigating next/previuos mark from
annotation navigation

2019-12-07: Bump upgraded asserts to 10% sampling rate

2019-12-07: Disambiguate profile menu item-derived new
window vs new tab shortcuts by putting NewTab:title or
NewWindow:title as the identifier. It should not collide
because all other identifiers are statically defined.

2019-12-07: Revert "Disambiguate new tab vs new window in
popup list of profile names for keyboard shortcuts"

This reverts commit
961e12ac9ce1b1158962d78c2ace076fe93a37c7.

2019-12-07: Revert "Fix touch bar items that select
profiles, broken in previous commit"

This reverts commit
8758d9c4f5fd9e5ac6bb0c0d515e9112ba85e9a0.

2019-12-07: Fix touch bar items that select profiles, broken
in previous commit

2019-12-07: Disambiguate new tab vs new window in popup list
of profile names for keyboard shortcuts

2019-12-07: Disable quicklook for schemes other than http(s)

2019-12-07: Disable DECRQCRA by default. Prompt when someone
tries to use it.

2019-12-07: Work around a crash when changing the window's
style mask in/out of borderless.
https://feedbackassistant.apple.com/feedback/7483151

2019-12-06: Require permission to steal focus by control
sequence. Reveal the session after stealing focus

2019-12-06: Make it harder to misuse
iTermFileDescriptorClientConnect

2019-12-06: Reject archives with duplicate metadata keys

2019-12-06: Expand use of safe addition function

2019-12-06: Prevent possible signed integer overflow

2019-12-06: Ignore metadata keys that are not understood.

2019-12-06: Introduce v2 of signed archives. The signature
goes at the end and signs everything that precedes it,
rather than just the payload. Version 1 is still accepted as
input. Output contains the v1 header but also contains the
v2 signature, which is preferred when available. The
migration path will be to ship this and rebuild all its
files with it. Then the next version will build only v2.
Then the version after that will accept only v2, and the
migration code can be deleted.

2019-12-05: Replace direct calls to realloc(f) with safer
alternatives

2019-12-05: Add Smoooooth color preset to default set

2019-12-05: Preview color presets when highlighting one

2019-12-05: Fix GPU renderer's drawing of selected tabs

2019-12-05: A bit of cleanup for the log plaintext option in
the save panel

2019-12-05: Combine log>start and log>stop. Indicate if
logging is on with a checkmark. Remove some nasty old code.
Add the ability to log just plain text from the menu item.

2019-12-04: Add the option to log plain text. Refactor
logging.

- When a session is restored, resume its autolog if
applicable.  - When a session is restarted, begin a new log
file. Assign the session a new unique ID.  - Perform logging
on a separate queue from reading to improve parallelism.

2019-12-04: Handle starting a three-finger selection with a
mouseDragged: event. Issue 8350 (second attempt)

2019-12-04: Fix the test for whether three-finger tap
gestures for quicklook are enabled. Issue 8306

2019-12-03: Fix a bug where tmux windows' Y origin would
change if there was a tabbar that appeared shifted it down.
Issue 8509

2019-12-02: Add advanced pref to control generous rounding.
Yet another hack for f'ing consolas

2019-12-02: Rewrite paths discovered via
PROC_PIDVNODEPATHINFO to replace root-firmlinked paths with
their shorter names on 10.15 (e.g.,
/System/Volumns/Data/Blah -> /Blah). From PR 409 by
erikolofsson, modified by gnachman.

2019-12-02: Change how the git status bar component
truncates. Only offer one variant. Let the superclass know
it truncates the tail so it doesn't try to be clever about
picking a variant that fits.

2019-12-01: Remove unused lru_cache

2019-12-01: Validate the dragging source in the status bar
setup destination collection view

2019-12-01: Quarantine downloaded files

2019-12-01: Fix infinite loop for creating archive with
self-signed cert.

2019-12-01: Remove CPU profiler from menu

2019-12-01: Remove sigusr2 handler after CPU profiling is
finished
