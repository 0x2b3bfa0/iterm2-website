2020-03-23: Require user consent to clear scrollback history
with CSI 3 J. Fix a bug in announcements that have shortcuts
and are dismissable by keydown that the shortcuts didn't
work. Issue 5058

2020-03-23: Fix initial enabled state of the configure
status bar button when show status bar is off

2020-03-23: Never produce a null string from
iTermFindPasteboard. Issue 8783

2020-03-23: Get rid of absurd hacks from a long time ago.
Now that there are real weak pointers, I don't need to keep
track of whether a PTYSession is registered. In fact, I
think I never had to do it at all; I should've just nilled
out PTYTask's delegate after calling stop.

2020-03-23: Make orphan adoption more async. Search for
sockets in a background queue. There's no need to block the
main queue while doing any of this work. It's guaranteed to
begin only after all window states have finished restoring,
and can then take as along as it likes. Issue 8781

2020-03-22: Fix a bug where the flags-changed event tap was
disabled when the app resigned key and the app that was
becoming key had secure input turned on. You can actually
run a flags-changed event tap when secure input is on. This
caused a really hard to understand bug where double-tap to
open hotkey would break when both iTerm2 and the app being
switched to had secure input enabled. Issue 8180

2020-03-22: Handle unsupported shell when using
internet-based shell integration installer

2020-03-22: Fix a bunch of bugs in internet-free shell
integration installation.

2020-03-22: Support ZDOTDIR in internet-free shell
integration install. Update the wording in the steps to be
more accurate

2020-03-22: When you add your first touch bar item post a
notification explaining how to customize the touch bar.
Issue 8775

2020-03-22: Improve how the find pasteboard is used. Only
update the key window's search fields. When you do Erase
Search History, clear out the current query. Issue 8782

2020-03-21: Giant refactor of key bindings code.

Add iTermKeystroke, iTermTouchBarItem,
iTermKeybindingAction, iTermKeyMappings,
iTermTouchbarMappings, and iTermPResetKeyMappings. Delete
ITKeyBindingMgr.

Various odds and ends got cleaned up.

The only real fix is that now shortcuts in the table views
will be consistent with shortcuts in the shortcut input
view. For example, shift + : will show up as ; in both
places now.

Issue 8770

2020-03-19: Tweak wording of inline image display permission
prompt. Issue 8771

2020-03-18: Giant refactor of multiserver. Fixes a bunch of
synchronization bugs. Introduces some new synchronization
mechanisms to make code like this safer.

Also fixes a bug where multiserver didn't catch sigpipe.

2020-03-18: Fix leak of session made from adopting an orphan

2020-03-14: Prevent a crash when controlTextDidEndEditing:
is called on the window arrangement prefs panel but now row
is selected. Happens if you delete a row while editing it
name.

2020-03-14: Add option to focus window on right or middle
click. Issue 4918

2020-03-14: Don't close tmux integration session if a window
doesn't exist when you try to open it. The window may have
died on its own after it was created. Issue 8767.

2020-03-14: Add a checkbox to the tmux dashboard to control
whether it opens when there are hidden windows. Issue 8691

2020-03-14: Show search result locations in scroll bar.
Issue 5302

2020-03-12: Allow 2-touch mouse-down to get reported. Issue
8481

2020-03-12: Support symlinks in DynamicProfiles, and also
support DynamicProfiles itself being a symlink

2020-03-11: Use dark text on fake window title bar when it
has a light tab color

2020-03-11: Update title and border views when changing the
tab color so that when there's a Minimal window without a
tabbar its background will change. Issue 8760

2020-03-11: Add debug logging for all NSBeep calls

2020-03-11: Don't create a flags-changed event tap when the
advanced pref says not to. Issue 3316

2020-03-11: Save overridden fields in arrangement. When
restoring, use the underlying profile when available and
then modify it by copying over the overridden fields from
the arrangement. Issue 8759 (and countless others)

2020-03-09: Remove some silly functions that didn't need to
exist

2020-03-09: Fix a bug where option to not report a mouse
event was broken in the recent refactor. Issue 8756

2020-03-08: Cancel three finger tap if the touches move.
Issue 8751

2020-03-08: Show number of search results in find-on-page
text field. Issue 4578

2020-03-07: Fix crash

2020-03-07: Add menu item to prompt to convert tabs to
spaces when pasting. Issue 6288

2020-03-07: Fix typo

2020-03-07: Move tabbar into titlebar accessory when
channging number of tabs, if needed

2020-03-07: Change how smart selection actions are run to
use the command runner instead of system(). Log output to
script console. TODO: Ensure the command runner is retained.
Issue 8753

2020-03-06: Fix failing tests

2020-03-06: Optimize Images. PR 415.

2020-03-05: Add a bunch of debug logging for issue 8738

2020-03-05: Fix AutoLaunch.scpt

2020-03-05: Fix the preview of window arrangements with
multiple monitors. Issue 8706

2020-03-05: Pass the curor's rect in place of the view rect
to UAZoomChangeFocus. This is what chromium does in
render_widget_host_view_mac.mm. Issue 8642

2020-03-05: Add the option of setting ITERM2_COOKIE in new
sessions. These cookies are reusable. If you need to be able
to launch Python scripts from an iTerm2 session without
confirmation, this is a secure way to do it. It is secure
because processes external to iTerm2 can't get their hands
on these cookies and the user has to give permission to
enable this; the threat model is to prevent access from
other apps, particularly web browsers, from gaining access
to the API. Suggested in issue 8714

2020-03-03: Allow Applescript to launc Python script with
absolute path. Issue 8717

2020-03-03: Don't crash if profiles have crazy values, which
can happen with dynamic profiles.

2020-03-03: Try to fix screenDidLock crash by removing
observer on dealloc. Use different method names for the
class vs instance observers so I can tell which one is
crashing

2020-03-03: Enable zombies in the nightly build to track
down crashes

2020-03-01: Call refresh immediately after handling input
that comes within 10ms of a keystroke to reduce latency.
This is good for about 20ms of latency with the Metal
renderer according to typometer.

2020-03-01: Disable metal stats to try to prevent memory
corruption

2020-03-01: Respond to OSC 4 and 10, and 11 with 16 bit
color components. See mailing list thread with subject line
"Vim cannot detect background correctly when ssh to a remote
server"

2020-03-01: Support control-arrow keys in CSI u mode. Issue
8719

2020-03-01: Add an experimental setting (on in beta) that
makes mouse wheel clicks always scroll. Issue 8419

2020-03-01: When TERM contains 'screen' convert control
sequences internally to xterm. Issue 8726

2020-03-01: Add support for translating TERM=screen codes
outside tmux integration

2020-03-01: Make window background not normally clear
because it breaks the light colored outline around windows
on macOS 10.15. Consequently, we do not need the tabbar
backing to be visible in compact windows. Also, fix how we
decide whether the division view should be visible when
tabbar is on loan

2020-03-01: Ensure window changes size when tabbar as
titlebar accessory disappears/appears. Ensure tabbar becomes
titlebar accessory when exiting full screen (either kind).
Issue 8731

2020-03-01: Organize the methods in PTYTextView into
sections and remove some dead code

2020-03-01: Replace calls to mouseHandlerCurrentSelection
with selection

2020-02-29: Move mouse handling code into its own file to
reduce the size of PTYTextView

2020-02-29: Bump python module version

2020-02-29: Don't set active_session_id in Tab.update_from
because it will always be None. Issue 8733

2020-02-29: Make the tab bar into a title bar accessory for
windows with a normal title bar (tabs on top, not minimal or
compact, not x-of-screen/no-title-bar/full screen). Issue
8731

2020-02-29: Add debug logging for function key presses

2020-02-29: Change broken pipe to session ended. Change
color to blue. Issue 7018

2020-02-28: [applescript] Don't resume from creating a new
window or tab until fork has finished so you can write to it
immediately. Issue 8730

2020-02-27: Don't open the git popup if not in any window.
Not sure how that's possible, but I saw it.

2020-02-27: Fix reentrant setStyleMask:

2020-02-27: Don't crash if keymap is a string somehow

2020-02-27: Prevent burying synthetic sessions, which crash

2020-02-27: Don't crash on 0-size window

2020-02-27: Don't crash when a keybinding handler has bogus
text

2020-02-27: Fix a stupid Catalina crash

2020-02-27: Don't ELog from applicationSupportDirectory
because then you get infinite recursion

2020-02-27: Prevent reentrant calls to windowDidMove:.
Sanity check keyInfo before formatting it. Fixes crashes.

2020-02-27: In minimal with colored tabs, don't draw the
underline past the right bound of the last tab when it is
selected

2020-02-27: Add minimalSelectedTabUnderlineProminence

2020-02-27: Offer to keep/merge keys when importing.
Refactor a bit.

2020-02-27: Allow multiple selection in key bindings. Allow
backspace to delete selected items

2020-02-27: Offer to merge presets with profile key
mappings. Issue 8718

2020-02-26: Fix handling of single quotes in scripts run
from semantic history. Issue 8710

2020-02-26: Don't attach the debugger to the xpc process
because it confuses poor xcode and makes it give up
debugging with signal 19 wtf

2020-02-26: Don't get a bogus timeout if launching an
applescript from the Scripts menu that does something
asynchronous. Issue 8644

2020-02-26: Add a profile pref to allow mouse reporting of
clicks and drags. Issue 8711

2020-02-26: Add advanced pref to disable document edited
indicator. Ignore jobs in 'Sessions>If there are jobs
besides' for document edited. Track the command line of the
child of login and the root process so we can test if they
are your shell. Issue 8507

2020-02-25: Quell log messae IIONumber -- 'num' is of type
'CFBoolean' -- expected: CFNumberRef. It doesn't like that I
passed a boolean to a property that's documented as taking a
boolean. Issue 8707.

2020-02-25: Precomposite indicators to prevent punch-through

2020-02-25: Don't make full screen flash make the window
transparent

2020-02-25: Use premultiplied blending for the highlight row
to keep it from punching a hole through the window. This is
an issue now that the window's background color is always
clear. Issue 8700

2020-02-25: Now that the window's background color is always
clear, the tabbar backing looks bad when using within-window
blending in dark mode. Change it to use behind-window
blending instead.

2020-02-25: Improve support for non-optimized ligature
drawing. Always draw full rows. Treat the first null in a
series of nulls as a space for ligatures like '# FIXME'.
Issue 7461

2020-02-25: Respect a key action of Ignore when there is no
terminal window. Issue 5127

2020-02-25: Synchronize access to queues array

2020-02-24: Set SSL_CERT_FILE and SSL_CERT_DIR. Issue 8722

2020-02-24: Add a bunch of logging for everything even
tangentially related to pidinfo polling

2020-02-24: When the working directory poller fails (nil
working directory) don't try to create a mark with it. This
has the unfortunate side effect of trying to get the working
directory again, causing high CPU utilization. Issue 8716

2020-02-24: Use http as default scheme when the domain name
is a single word with only a-z and 0-9 and does not start
with a digit. Issue 8419

2020-02-24: Prevent a crash in
compactLineDumpWithWidth:andContinuationMarks:. Issue 8725

2020-02-22: When attaching to tmux set window origin after
calling the completion selector because it may affect the
window's size (e.g., by burying the attaching session). This
fixes a bug where the window moves up by the height of the
tabbar when attaching to tmux with a single session that
auto-buries. Issue 8639

2020-02-22: Use process cache to query for oldest child of a
process. An attempt to fix 8716

2020-02-21: Add a bunch of debug logging for proc_pidinfo
slowdowns

2020-02-21: Fix a bug where compact windows without a tabbar
have a clear titlebar

2020-02-21: Add custom window restoration for full scren
windows in minimal/compact themes. Issue 6632

2020-02-21: Cancel color preset preview timer when
highlighting a non-color menu item.

2020-02-20: Add a delay before previewing a color preset
since it's not real fast to change.

2020-02-17: [Python,API] Add support for listing prompts by
ID. Add capabilities check for prompt ID and bump protocol
version number

2020-02-17: [API,python] Add ability to get prompt by ID

2020-02-17: [python,API] Expose prompt unique ID

2020-02-17: [python, API] Expose prompt state in
GetPromptResponse

2020-02-17: Add a pref for a custom tab title in new tabs.
Issue 8386

2020-02-17: [Python] Add 'user powerline glyphs' support.
Issue 8399.

2020-02-17: Let Xcode party on PreferencePanel.xib

2020-02-17: Remove titlebar decoration view outside beta.
Issue 8238

2020-02-17: Remove titlebar decoration view on 10.15.

2020-02-17: Make iTermServer a UIElement to remove its dock
icon

2020-02-17: Set passed-in filedescriptors nonblocking from
monoserver and multiserver

2020-02-16: 3.3.10beta1

2020-02-16: Move iTermServer to Contents/MacOS and move
it2run into resources so it can be signed properly

2020-02-16: Fix signing for iTermServer

2020-02-16: Enable pidinfoXPC by default

2020-02-16: Polish arrangements prefs. Allow multiple
selection. Allow backspace to delete. Allow renaming in
table view. Add support for undo. Issue 4627

2020-02-16: Correctly map 'increase height' shortcut. (#414)

Signed-off-by: Jesse Stuart <hi@jessestuart.com> 2020-02-16:
Cause iTermServer to be killed on logout

2020-02-16: Simplify Python API security model.

2020-02-16: Pass an array of strings in the applescript
launch API script 'arguments' parameter

2020-02-16: Pass an array of strings in the applescript
launch API script 'arguments' parameter

2020-02-15: Ensure global setting overrides don't get
stomped when loading remote prefs

2020-02-15: Implement multiserver.

Use one daemon to house all child processes.

2020-02-15: Don't crash when tmux sessions change while
editing a session's name in the dashboard

2020-02-15: Fix crash when removing a smart selection rule
while editing one of its fields

2020-02-15: Add missing it2run file

2020-02-15: Compress assertion message for the divorce bug
so it doesn't get truncated

2020-02-15: Fix crash when downloaded file has no path

2020-02-13: Make the bell ratelimit configurable. Issue 4658

2020-02-13: Do not log bells when plain text logging is on

2020-02-13: Add it2run so you can launch API scripts from
the command line without getting nagged for permission every
time

2020-02-11: Tweak message, fix warning

2020-02-11: Improve the logging error notification. Reveal
the responsible setting when you click it. Issue 8687

2020-02-11: Tweak window borders: reduce thickness to one
pixel. Don't inset on Catalina.

2020-02-11: Make window border off by default on 10.15
because it's ugly in light mode. Change how the corners are
drawn to make them look better.

2020-02-11: Fix tmux dashboard when connection includes
nonbreaking space, other other characters that don't
round-trip through menu item titles. Issue 8520

2020-02-10: Add iTermPromise

2020-02-09: Add a retry mechanism for determining the
process ID that owns a connection. Issue 8684

2020-02-09: Reject connection with no pids for issue 8684

2020-02-09: Support command line parsing for python3.8
scripts

2020-02-09: When restoring a  profile in automatic profile
switching, prefer the underlying profile to the saved copy.
Only use the saved copy if it doesn't exist. This is because
we want changes to the underlying profile to be applied. For
example, changing the colors for to match dark mode. Issue
8677

2020-02-09: Update prefs panel text for window border.
Enable it by default on 10.15 and up. Fix build break

2020-02-09: Draw nice round borders for transparent windows
on 10.14+. Issue 8681

2020-02-09: Temporarily disable respecting soft boundaries
if cursor leaves them while making a selection. Issue 8683

2020-02-09: Bump deployment target of UKCrashReporter.xib to
12.2. This fixes a warning. Amusingly, it still works on
12.1 because xcode is lying as usual

2020-02-09: Fix warning

2020-02-09: Enable some experimental features that are
ready. Reorganize them in the .m file to ease future updates

2020-02-09: Bump upgraded asserts to 100%

2020-02-09: Update UKCrashReporter to use a xib. Override
its window and implement closeCurrentSession: so cmd-w will
work with it

2020-02-09: Improve internet-free shell integration
installer: prevent inputrc from screwing up the prompt by
launching bash with INPUTRC=/dev/null; don't use bracketed
paste even if enabled; use base64 --decode, which works in
both BSD and Gnu.

2020-02-09: Interpret clean and dirty properly in remote git
state variables. It isn't a boolean.

2020-02-09: Fix incorrect vertical alignment of attribute
string status bar components when using nonstandard fonts.
It's especially obvious when you use Mono Extra Light 16.
Issue 8665

2020-02-09: Fix failing tests, a crash during test, and use
of an uninitialized value.

2020-02-08: Ensure the tabbar control's delegate is not the
window controller before closing its tabs. This could be
necessary if windowWillClose doesn't get called for some
reason.

2020-02-08: Ignore errors from tmux after trying to set
window sizes. That's because we update window sizes when a
window closes, and if many tabs/panes close at once (e.g.,
cmd-shift-W) then it will try to resize a window that
doesn't exist and the connection will break.

2020-02-08: Fix use of undefined variable

2020-02-08: When preferring full ligature support to speed
treat spaces as drawable characters. Issue 7461

2020-02-08: Fix typo

2020-02-07: Kill/hide tmux windows when closing a window
with Shell>Close Terminal Window

2020-02-07: Don't resize tmux client when window is closing.
Prevents spamming the command line. Issue 7770

2020-02-07: Fix conservative url guessing to allow ports.
Issue 8673

2020-02-07: Fix a bug where, when mod+number to select tab
is disabled, all tabs show all modifiers.

2020-02-06: Clean up iterm2Invoke support

2020-02-06: Break retain cycle in iTermProcessInfo in an
attempt to fix a crash in cxx_dealloc

2020-02-06: Fix a crash when a tmux session exits while
you're editing its session's name in the dashboard

2020-02-06: Don't crash when flipping a 0x0 image

2020-02-06: Don't try to sendaction to a menu with a submenu
for a keybinding. Not sure how that happened, though.

2020-02-06: Fix a nil string crash

2020-02-06: Don't call _setWebSecurityEnabled: if it doesn't
exist. This probably means that javascript in script-driven
popovers can't make API calls any more.

2020-02-06: Don't register or unregister a shortcut while
the session is supsended since that hits an assert. This can
happen when a bonjour host appears/disappears. This needs
more testing.

2020-02-06: Fix an out of bounds lookup when removing
nameless APS entries in prefs

2020-02-06: If there is no user fixed pitch font, fall back
to the system font. Fixes a crash in font size estimation
when it's given a nil font

2020-02-06: Fix extremely frustrating longstanding crash.
Don't do things in dealloc. This ended up calling into metal
availability checks that caused the window to get retained
and autoreleased, leading to a zombie.

2020-02-06: Don't crash if you try to show a download in
finder but it has no path for some reason

2020-02-06: Fix uninitialized error in scp download when a
download fails

2020-02-06: Fix a very common crash in
restoreTabsFromArrangement:named:sessions:

2020-02-04: Center the thingy in the mouse in the sketch
file

2020-02-04: Properly center the thingy on the mouse icon

2020-02-03: Fix background color of upload/download items in
10.14. Issue 8651

2020-02-03: Change LC_LANG to LANG. Also, let Xcode party on
the xib. Issue 8661

2020-02-03: Move code for managing the global variables into
its own file. Make how we observe theme changes current for
modern versions of macOS. Inspired by PR 413

2020-02-03: Don't limit max width of an attribute text
component to the view's size when computing its width. Issue
8665

2020-02-03: Make autorainbow a persistent setting that
updates colors as components come and go. Give it an
automatic mode that adjusts between light and dark rainbows
depending on the background color of window decorations.
Issue 8101

2020-02-02: Move dock hiding and menu bar hiding logic into
its own class. Consider which screen has the dock when
deciding whether to hide it, rather than assuming it's
always on the main screen. Issue 8487

2020-02-01: [python] Fix a bug where creating a
LocalWriteOnlyProfile from a Profile would mutate values in
the Profile by json encoding them.

2020-02-01: Add option for the password manager to require
reauthentication after the screen locks. Issue 6401

2020-02-01: Disable DVRDEBUG in debug builds

2020-02-01: Add debug logging for tmux dashboard

2020-02-01: Don't show documented edited indicator if the
current job's pid equals the one we spawned. Issue 8654

2020-02-01: Fix crash in DVR
